{"version":1,"ops":[{"type":1,"author":{"id":"04135dc995e2fdcd322aaf4268dbf04630a3cc7c"},"timestamp":1511863619,"metadata":{"github-id":"MDU6SXNzdWUyNzczMjUzNjQ=","github-url":"https://github.com/perl11/cperl/issues/342","origin":"github"},"title":"check 5.27.5 strchr=\u003ememchr changes for security","message":"we don't allow \\0 in code and identifiers, but those late memsearch API changes in 5.27.6 with c33d640f4e90281f3ea730924872c98bd8a5a593, esp. in toke.c 85bb8b90c60f216f831d25542414634aa17a32fc seems to let them sneak in again.\nthe message states to affect only string input, which would be ok.\nmemchr/memrchr is good when we got the length for cheap, as the loop doesn't need to check for \\0.\nbut in many cases it needs to check for illegal and dangerous embedded NULs.\n\nsee the `smoke/merge-5275` branch and blead.\n\n* missingterm: dies with a proper message, **OK**\n* check_uni: only check and warn, should be **OK**\n* scan_const: allows now \"\\\\N{..\\0..}\" which would previously be illegal\n  before: Missing right brace on \\N{} at ..., within string\n  now: Unknown charname '' at ..., within string\n  should be: bad_charname: Invalid character in \\\\N{\\0}; marked by \u003c-- HERE in ...\n  Fixed with smoke/gh342-illchar\n* yylex\n* scan_heredoc\n* incline: adjusts #line and linecounter. esp. useful in binary filtered input. **OK**\n* intuit_more: looks bad. \"[\\0]\" is now legal. problems:\n  - `@a=(0,1); print $a[0\\0];` =\u003e 0. Before: \"\"\n  - `$a=[0,1]; print $a-\u003e[0\\0];` =\u003e 0. Before also 0\n  - `@a=(0,1); print \"0\" =~ m/$a[0\\0]/;` =\u003e 1. Before \"Missing right curly\"\ndue to toke.c:5474 yylex(\\0)\n```\n         if (s++ \u003c PL_bufend)\n            goto retry;                 /* ignore stray nulls */\n```\n* scan_inputsymbol: check invalid glob\n  Fixed with \"fail with Glob not terminated on NUL in glob\" in smoke/gh342-illchar\n\nperl.c:\n* read_e_script: See #345. disallow \\0 in -e'...'\n\nop.c:\n* newATTRSUB_x (the name!): **OK** because namlen doesn't include the \\0\n* ck_entersub_args_proto (the proto): **OK** because this way Illegal NUL, syntax error is detected.\n  e.g. `sub a0 ([\\0$]) {}`\n* magic_set $^A (**OK** a bugfix), magic_setsig (a gv name) irrelevant\n\ndoio.c:\n* do_open6: the layer and mode name? (ok, fuzzed)\n* mode_from_discipline: the mode (ok)\n\npp:\n* pp_leavewrite: the PL_formtarget **OK**","files":null}]}