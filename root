{"version":1,"ops":[{"type":1,"author":{"id":"04135dc995e2fdcd322aaf4268dbf04630a3cc7c"},"timestamp":1520159118,"metadata":{"github-id":"MDU6SXNzdWUzMDIwNzQzODQ=","github-url":"https://github.com/perl11/cperl/issues/356","origin":"github"},"title":"merge blead 5.27.6 - 5.28.0","message":"This is a difficult one, mostly because Zefram went absurdly destructive in many of his changes. Not only the dumb_match branch, also changing some policies and more. Need to look more closely into his changes. Father broke the T_STDIO, T_IN and T_OUT typemaps by forcing double-close on existing file handles, which is fatal with glibc (#357). He went on by just ignoring the crashing test.\nSo far I have 36 rejections for Zefram, 4 important ones for Father Chrysostomos, 3 for Jarkko and khw, 1 for Ævar.\n\nThere's lot of good stuff by khw: mph (compiled uniprops for case folding and LB), wordwise string search, no SSE though yet. CLOEXEC support and more robust cleanup by Zefram, tr/// fixups by davem.\n\n```\ng cp -x `grep -v '^#' .old/merge-5.279|head -n10|cut -c-40`\n```\n\n* d3f0c815eccb54ae88550259c06aa395b2274580 remove doc hedge about autovivification - Zefram\nautovivification is not a bug anymore for them, but a feature. WTF. cperl will still try to fix this bug with the gv revamp.\n\n* 0740a29d60ebd4ff72090340b0140ec2210e90c7 stop using \u0026PL_sv_yes as no-op method - Zefram\nThis broke Devel::NYTProf, needed to be fixed up by adding CVf_NODEBUG to this empty CONSTSUB. See https://github.com/timbunce/devel-nytprof/issues/113\n\n* 5c8d1071aaf72214e66b1a224890384ab6ca5153 Carp: Avoid run-time mods; StrVal workarounds - Father Chrysostomos\nand 7276ff5bb307b4639027305f3db927826089f646 Carp: Speed up longmess some more - Father Chrysostomos \nand esp. d642ec356d13ea4c17077c084c1cda93e9f9e69b Carp: Avoid string eval - Father Chrysostomos \n  These three changes moved the overloading logic from run-time to compile-time, blowing up compiled C files by a huge number (\u003e10x), so that even the simplest one-liners cannot be compiled anymore with \u003c= 8GB RAM. without string eval the compiler is forced to pickup overload also.\noverloading checks are entirely useless in a critical stacktrace. From now on also B::C and B::CC are being useless with perl5, not just the Bytecode compiler which was broken earlier. You really need a patched Carp.\n\n* d106cb46261708412bce33e1840ae6e8c17bea20 remove stray NULLOK/NN from apidoc directives - Zefram\nstray?\n\n* 0301e899536a22752f40481d8a1d141b7a7dda82 properly define perl_parse() return value - Zefram\n  exit(256) is not exit(0) on windows, only on U8 exitcodes. This change broke running `pod/buildtoc` on Windows. See also [perl #132577] where it broke Module::Install also.\n This change needed about 4 later fixups.\n\n* 76b35304cf4800e9e0f7b370b9f1f40bc6cfb7e0 Make Bad name error less unhelpful - Father Chrysostomos\ncperl doesn't have this unhelpful Bad name error message, it rather correctly got the missing string delims right.\n\n* 7b0ac4577d4cc7902dfa379f3318a8af1b736a3d pod: start referring to 5.6 and pre-5.6 as \"ancient\" instead of just \"old\" - Ævar Arnfjörð Bjarmason\nOf course ancient is pre-5.6. 5.6 is just old, and 5.6.2 still one of the best perl versions, with 5.8+ destroying the semantics of the SV utf8 flag, hash tables, the compiler and lots more.\n\n* I'm not sure yet about 6661956a23de vivify array elements when putting them on stack - Zefram\nLooks like a massive change, too good to be true.\n\n* And b2cd5cb1d8b3c8a7a7  Unicode::UCD: max code point is now IV_MAX - Karl Williamson\nMAX_CP still needs to be 0x10ffff, not IV_MAX. This is used for reverse search in the invlist.\n\n* 86452548f54ae14813026a35a2c67498bfcdf626 mktables: Avoid some work - Karl Williamson\nbroke [cperl #166] HANGUL FILLER fixups. range complements cannot be sped up like this.\n\n* ~~8c20b11d5137b21b9b47609f4e97e1d5c3d355f1 perluniprops: Improve sorting - Karl Williamson\nTODO broke folding?~~\n\n* 56e48c10762ae388167c2f2449eea8553b396093 perluniprops/mktables: Add code points matched annotations - Karl Williamson\nbroke mktables\n\n* 8e991213a1d4f6b7526be79687f9170a9201412d Emulate some C99 macros and typedefs - Karl Williamson\nreplaced U64_CONST with UINT64_C, breaking all modules using it. It was in handy.h, in the public API.\nused an undefined U16_TYPE, not U16TYPE. broke mingw/msvc without C99 compilers.\n\n* 6da090e6cb9d18c5db3bb70c8c4d0c7e58183273 Avoid newGVgen in default typemap - Father Chrysostomos and related commits\n 732d3893ab63739910640c98c1cc83ab7bb1332c Avoid newGVgen in blead-upstream modules - Father Chrysostomos\n 76eb84800b51f32ecd4ab68d15ca549f2f67721b Increase $ExtUtils::Typemaps::VERSION to 3.37 - Father Chrysostomos\n244d26825825c6a1d5bc181e6da699d48bcb51a4 perldelta for #115814 - Father Chrysostomos\n d269f586dd6705f80163f642c0aa81f0e7a72bca Declaration after statement in typemap - Father Chrysostomos\n\n  This is completely wrong. It also leads to #357 where p5p just decided to ignore this fatal error.\nA IO object in a lexical (obj or ref) must be gensymed, it can be collapsed to a single `__ANONIO__` symbol per package, as XS packages may want to handle more then one T_STDIO. E.g. stdout, and stderr. The name should be kept if already existing. Avoiding the leak leads to double-close, which is fatal on glibc.\n\n* f3c710fe342032112ac92fc893f5ef050b4f7024 rewrite \"ref\" documentation for clarity - Zefram\n  Deleting the good parts and adding wrong parts is some strange concept of clarity.\n\n* 42034324c570544c22fe9a73865f20ab45e9d989 show modern usage for {XS,Dyna}Loader - Zefram\n  advising to break CPAN by using modern syntax.\n\n* 64def2aeaeb63f92dadc6dfa33486c1d7b311963 perform system() arg processing before fork - Zefram\n  This \"fix\" sounds hardly correct. It breaks taint checks for sure, which are esp. important for system args. TODO [perl #121105](https://rt.perl.org//Public/Bug/Display.html?id=121105)\nIt also broke Win32, VMS and numeric args.\nThe subsequent fixup \n8fe3452cc6ac7af8c08c2044cd3757018a9c8887 preserve numericness of system() args on Win32 - Zefram\nstill does not handle VMS and taint, but calls GETMAGIC on all args now twice.\n\n---\nComplete list so far:\n\n#- a252c8fe5fbed43d9b362ed97d57a5a7764fac62 update newGIVENOP() doc for loss of lexical $_ - Zefram\n#- 76ed45178844dff782880573017d9b7c9fbc0007 regularise \"given\" - Zefram\n#- b69ef0135bfebf0c32023bcb970dbb95957b32e7 regularise \"when\" - Zefram\n#- 1c71ec5e58384a564f5eb9864d03334aa772afcc remove unused arg from newGIVWHENOP() - Zefram\n#- 64805db9f7c4784f6ddf4f97dcbe6fd820f05a45 merge switch sections in perlsyn.pod - Zefram\n#- 98729e54e4bb1f6f9e5e0a21c6e56461abe54dbf revise all given/when documentation - Zefram\n#- 5e1cca32ac612f0b59508a99fbff671a693f39b9 update perlexperiment.pod re smartmatch - Zefram\n#- 5f3202fa3e77c4a20de590df045af4683aaedffa eviscerate smartmatch - Zefram\n#- e32748c9f33b07135a5e2e4f1cdcdf22cd3a93ad remove now-unused \"M\" debugging flag - Zefram\n#- 8a0ed425bf56098485707c69bba62ee2404bef3f test details of smartmatch overloading - Zefram\n#- ab179ac766f9eda4c7f539d09c43b02b45938b5c drop op flag for implicit smartmatch - Zefram\n#- 25233fb4d503834fd10cefc6b551240224a7f31a canonicalise smartmatch overload truth values - Zefram\n#- 1068631d8485410b2f8645d5413bbed47244a4a8 update doc in lib/ about smartmatch - Zefram\n#- fb24bb2d5fb05aef6336a32777331137e881eff5 test $swap arg for smartmatch overload - Zefram\n#- 9e0909b2180c408354ce24b6c742f4b79e783d11 perldelta for smartmatch changes - Zefram\n#- 793c2ded15ca832d1df1fabbc3b2e7562a057697 In some systems st.ino is never negative. - Jarkko Hietaniemi\n#- 8843856e9716655549cce789b3338e1d4c72fffb More robust version of 793c2ded. - Jarkko Hietaniemi\n#- 3676f9e77d46b61f4785aad171f02bed29df0c07 False false. - Jarkko Hietaniemi\n#- 869b8c119a7436d3373e1325925a8b753d0e7805 remove useless \"default\" mechanism - Zefram\n#- 5086635a9f7a492b5a0c6228ecf7a22abbabeef6 avoid gratuitous given/when in test - Zefram\n#- af8bd34d16b94bde32535062ba4e88407be233a0 use LOOP struct for entergiven op - Zefram\n#- df9e1bc13efe0941735d662db5683d62b3851535 use blk_loop format for CXt_GIVEN - Zefram\n#- df16d5564aa82a94953a0bccfc9917bc140ead02 revise block_givwhen for sole use by \"when\" - Zefram\n#- 619bbb9ab0f3cffda05f980b2ebb5bf660ad6962 make loop control apply to \"given\" - Zefram\n#- 97b4caa610942fa2caded4f8ec03ac72089cd30e remove useless \"break\" mechanism - Zefram\n#- b4904f80ff3e727173a3d8a9856827695e1af0ad make \"when\" do implicit \"next\" - Zefram\n#- e98c3eae7b9c9628400af33f6ac77a6feebb4f3f remove unused CXp_FOR_DEF and OPpITER_DEF - Zefram\n#- b1a6328e96a123f6ca713df406f01c2f4a2f2b7b perldelta for more switch changes - Zefram\n#- 40b0df696c4f45c9e0e43ec2121b53bc06a586db make \"outside a loop\" error messages consistent - Zefram\n#- 2ce94a867b15d96bd49eb8807d39df950f3a1087 re_intuit_start(): skip too short variant utf8 pat - David Mitchell\n#- 56e48c10762ae388167c2f2449eea8553b396093 perluniprops/mktables: Add code points matched annotations - Karl Williamson\n#- 76b35304cf4800e9e0f7b370b9f1f40bc6cfb7e0 Make Bad name error less unhelpful - Father Chrysostomos\n#- d3f0c815eccb54ae88550259c06aa395b2274580 remove doc hedge about autovivification - Zefram\n#- 16ea2c1905a8b12a3ddd72561c74de0063cbcc40 merge leavegiven op type into leaveloop - Zefram\n#- 8c49c7c16863f886a6a4da3b585463cd16a8b976 fix \"LOOP_GIVEN\" constant in PL_block_type[] - Zefram\n#- 284a3526271b040abd48aef39f61e8bacbf16645 change \"when\" keyword to \"whereso\" - Zefram\n#- 15e4ac9a427692a356fe62b255db9e08982879f5 internally change \"when\" to \"whereso\" - Zefram\n#- 84ac76a7475419f4ac6e5a6935522f7b7ebb0e2c better name for parameter to newGIVENOP() - Zefram\n#- f68519ee3f12e5ba41a022ef88ce3d6c3901807f add \"whereis\" - Zefram\n#- d6374f3d794e2a640258023e92e8d922409215ec perldelta for more switch changes - Zefram\n#- 86452548f54ae14813026a35a2c67498bfcdf626 mktables: Avoid some work - Karl Williamson\n#- d106cb46261708412bce33e1840ae6e8c17bea20 remove stray NULLOK/NN from apidoc directives - Zefram\n#- 7b0ac4577d4cc7902dfa379f3318a8af1b736a3d pod: start referring to 5.6 and pre-5.6 as \"ancient\" instead of just \"old\" - Ævar Arnfjörð Bjarmason\n#- 6da090e6cb9d18c5db3bb70c8c4d0c7e58183273 Avoid newGVgen in default typemap - Father Chrysostomos\n#- 732d3893ab63739910640c98c1cc83ab7bb1332c Avoid newGVgen in blead-upstream modules - Father Chrysostomos\n#- 76eb84800b51f32ecd4ab68d15ca549f2f67721b Increase $ExtUtils::Typemaps::VERSION to 3.37 - Father Chrysostomos\n#- d269f586dd6705f80163f642c0aa81f0e7a72bca Declaration after statement in typemap - Father Chrysostomos\n#* f3c710fe342032112ac92fc893f5ef050b4f7024 rewrite \"ref\" documentation for clarity - Zefram\n#- 42034324c570544c22fe9a73865f20ab45e9d989 show modern usage for {XS,Dyna}Loader - Zefram\n#- da4e040f42421764ef069371d77c008e6b801f45 merge branch zefram/dumb_match - Zefram","files":null}]}