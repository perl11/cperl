{"version":1,"ops":[{"type":1,"author":{"id":"04135dc995e2fdcd322aaf4268dbf04630a3cc7c"},"timestamp":1515580012,"metadata":{"github-id":"MDU6SXNzdWUyODczODI3MDA=","github-url":"https://github.com/perl11/cperl/issues/354","origin":"github"},"title":"Missing compile-time AvSHAPED detection in nested scopes","message":"PADs in nested scopes are at early compile-time only NULL FAKE placeholders to the outer PADs. Thus some compile-time checks do fail to detect the real SV capabilities, such as AvSHAPED.\n\nE.g:\n```\nmy @a[1];\nsub { $a[1] = 1 }-\u003e();\n```\nwill miss the compile-time error inside the closed over sub.\nAlso all uoob (compile-time out-of-bounds checks) optimizations are missing on those nested fake PADs.\n\nAdd new pad API **pad_findmy_real** to walk the `CvOUTSIDE(PL_compcv)` padlist until the real, non fake padsv is found. And **pad_find_outer** as helper to perform the pad_findlex search.\nThis is also needed for the `t/op/class1.t` #311 problem with `has` fields added in eval blocks.\n\nNote that this real sv may not be used to change or upgrade it in the compiler, only to find the real sv.\nThis error goes back to the very first cperl 5.22.1","files":null}]}