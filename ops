{"version":1,"ops":[{"type":5,"author":{"id":"04135dc995e2fdcd322aaf4268dbf04630a3cc7c"},"timestamp":1467616728,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDcxMTY5MjU5NQ=="},"added":["enhancement"],"removed":[]},{"type":5,"author":{"id":"04135dc995e2fdcd322aaf4268dbf04630a3cc7c"},"timestamp":1467616728,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDcxMTY5MjU5Ng=="},"added":["upstream"],"removed":[]},{"type":3,"author":{"id":"04135dc995e2fdcd322aaf4268dbf04630a3cc7c"},"timestamp":1468489901,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDIzMjYxOTc2OA==","github-url":"https://github.com/perl11/cperl/issues/176#issuecomment-232619768"},"message":"## solaris\n\nworks for simple scripts, because it's trivial there.\n\n```\n$ ./miniperl -Ilib -u -e'print \"ok\\n\"'\n$ ./a.exe\nok\n```\n\naccessing argv/argc fails on the empty PL_argvgv symbol while dumping. init_argv_symbols/init_postdump_symbols is uninitialized for -u.\n\n```\n    /* init_postdump_symbols not currently designed to be called */\n    /* more than once (ENV isn't cleared first, for example)     */\n    /* But running with -u leaves %ENV \u0026 @ARGV undefined!    XXX */\n    if (!PL_do_undump)\n    init_postdump_symbols(argc,argv,env);\n```\n\n## darwin\n- needs -Duseshrplib\n- uses unexec_malloc, which uses malloc_zone, before -u. After -u, running the dumped code it uses malloc().\n- fails with Bad address when dumping __bss DATA segments. With a static libperl.a also with __data and __common.\n- with a static libperl.a my_edata is not in .DATA, but in __common. nm disagrees with run-time.\n- works under the debugger\n\n## elf (linux)\n- dumps works fine, but run-time fails when freeing a dumped SV: parser-\u003elinestr (char*)\n  via safesysfree, which should be freed with free instead. (_easy to fix by only using malloc_)\n\n``````\n#3  0x00007ffff6d3d966 in malloc_printerr (action=3,\n    str=0x7ffff6e2c442 \"corrupted double-linked list\", ptr=\u003coptimized out\u003e, ar_ptr=\u003coptimized out\u003e)\n    at malloc.c:5007\n#4  0x00007ffff6d3e936 in _int_free (av=0x7ffff7064b20 \u003cmain_arena\u003e, p=\u003coptimized out\u003e,\n    have_lock=0) at malloc.c:4006\n#5  0x000000000054f011 in Perl_safesysfree (where=0xad0290) at util.c:390```\n\n``````","files":null},{"type":3,"author":{"id":"04135dc995e2fdcd322aaf4268dbf04630a3cc7c"},"timestamp":1468495429,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDIzMjYzODEzOA==","github-url":"https://github.com/perl11/cperl/issues/176#issuecomment-232638138"},"message":"Run init_postdump_symbols 2x with -u:\nWe need the  %ENV \u0026 @ARGV symbols during BEGIN, and we need to re-initialize in dumped binaries.\n\n```\n    /* init_postdump_symbols not currently designed to be called */\n    /* more than once (ENV isn't cleared first, for example)     */\n    /* But running with -u leaves %ENV \u0026 @ARGV undefined!    XXX */\n    init_postdump_symbols(argc,argv,env);\n```","files":null},{"type":5,"author":{"id":"04135dc995e2fdcd322aaf4268dbf04630a3cc7c"},"timestamp":1480581512,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDg3ODEwODc0Ng=="},"added":["in progress"],"removed":[]},{"type":5,"author":{"id":"04135dc995e2fdcd322aaf4268dbf04630a3cc7c"},"timestamp":1490872556,"metadata":{"github-id":"MDE0OlVubGFiZWxlZEV2ZW50MTAyMjEwOTIzOQ=="},"added":[],"removed":["in progress"]}]}